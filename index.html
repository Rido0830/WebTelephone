<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>SkyWay通話デモ</title>
  <script src="https://cdn.webrtc.ecl.ntt.com/skyway-latest.js"></script>
</head>
<body>
  <h1>SkyWay通話デモ</h1>
  <p>あなたのID: <span id="my-id"></span></p>
  <input id="peer-id" placeholder="相手のID">
  <button id="call">通話開始</button>
  <audio id="remoteAudio" autoplay></audio>

  <script>
    const peer = new Peer({
      appId: "10232c12-2b1d-4bcb-b424-944877352c03", // ←ここはアプリケーションID
      debug: 3
    });

    peer.on("open", id => {
      document.getElementById("my-id").textContent = id;
    });

    document.getElementById("call").onclick = async () => {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      const call = peer.call(document.getElementById("peer-id").value, stream);
      call.on("stream", remoteStream => {
        document.getElementById("remoteAudio").srcObject = remoteStream;
      });
    };

    peer.on("error", err => {
      document.getElementById("my-id").textContent = "エラー: " + err;
    });
  </script>
</body>
</html>
